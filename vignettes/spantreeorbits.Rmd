---
title: Spanning Tree Orbits
output: 
  html_document:
    mathjax: https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js
    self_contained: no
---


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, echo = FALSE, warning=FALSE}
library(magrittr)
library(stringr)
library(spantreeorbits)
source("./rgl_setup.R")
rgl::setupKnitr(autoprint = TRUE)
```

The goal of **_spantreeorbits_** is to use algebra to generate the orbits of the spanning trees of some polyhedra.

## Installation

You can install the development version of spantreeorbits like so:

``` r
install.packages("devtools")
devtools::install_github("JeffLansing/spantreeorbits")
```

## Example

Consider the tetrahedron, a self-dual polyhedron with 4 vertices, 4 faces, and 6 edges. (See: <https://dmccooey.com/polyhedra/Tetrahedron.html>)

We will use some external tools to assemble some data concerning this polyhedron. These are [Sage](https://www.sagemath.org/) and [GAP](https://www.gap-system.org/), which will be accessed in the following using [Sage Cells](https://sagecell.sagemath.org/). To run the code shown in any Sage Cell, click the *Evaluate* button below the cell.


```{=html}
<div>
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js" data-external="1"></script>
<script>sagecell.makeSagecell({"inputLocation": ".sage"});</script>
<link rel="stylesheet" type="text/css" href="https://sagecell.sagemath.org/static/sagecell_embed.css"  data-external="1">
<div class="sage">
  <script type="text/x-sage">
tet = graphs.TetrahedralGraph()
tet.relabel({0:1,1:2,2:3,3:4})
st = tet.spanning_trees()
for i,t in enumerate(st):
    print(t.edges(labels=False))
  </script>
</div>
</div>
```


Each of these 16 spanning trees of the (skeleton graph of) the tetrahedron has 3 edges, which connect all 4 vertices, without cycles. We can look at the kinds of trees on 4 vertices as follows.

```{=html}
<div>
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js" data-external="1"></script>
<script>sagecell.makeSagecell({"inputLocation": ".sage"});</script>
<link rel="stylesheet" type="text/css" href="https://sagecell.sagemath.org/static/sagecell_embed.css"  data-external="1">
<div class="sage">
  <script type="text/x-sage">
t4 = graphs.trees(4)
for i,t in enumerate(t4):
    t.relabel({0:1,1:2,2:3,3:4})
    print(t.edges(labels=False))
  </script>
</div>
</div>
```

So there are two different kinds of trees on 4 vertices. Each of the 16 different spanning trees for the tetrahedron will be one of these two kinds. The goal in this example is to find a group that acts on the set of spanning trees of the tetrahedron and produces exactly 2 orbits, each of which contains all and only trees of one kind.

According to [this document](https://doi.org/10.1016/j.tcs.2024.114593), in Table 1, there are exactly two nets of the tetrahedron. So later we might look at the connections between the two orbits, the two kinds of trees, and the two nets. This will be in a separate vignette.

Each spanning tree of the tetrahedron has 3 edges, and the tetrahedron is self dual, so we will look for some more data pertinent to these two sets of 3 edges (one set for the spanning trees of the tetrahedron, and the other for the spanning trees of its dual). We will use GAP for this.

```{=html}
<div>
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js" data-external="1"></script>
<div id="cell2">
<script type="text/x-sage">
s6 := SymmetricGroup(6);
ll6 := LowLayerSubgroups(s6,2);;Display(List(ll6, Order));
Print(StructureDescription(ll6[21]), ", ", StructureDescription(ll6[22]), "\n");
rc21 := RightTransversal(s6, ll6[21]);;
lrc := List(rc21, x -> ListPerm(x,6));;
for p in lrc do Print(p,"\n");; od;;
</script>
</div>
<script>
sagecell.makeSagecell({
inputLocation: '#cell2',
languages: ['gap'],
//Focus the editor
callback: function() {$('#cell2').find(".CodeMirror").get(0).CodeMirror.focus();}
});
</script>
</div>
```

When we evaluate this GAP code, we see that the symmetric group $ S_6 $ has 2 subgroups of order 36, called $ S_3 $ x $ S_3 $. Further, looking at the representatives of the right cosets in $ S_6 $ of either of these subgroups (shown here for the first one as a table with 20 rows), we see how to relate these cosets to the 2 sets of 3 edges mentioned above. We use the R code in this package to explain that relation. 

First we have to label the edges in the two sets in a canonical way. A figure will help to explain this.

```{r get_tet_maps, echo=FALSE}
data(tetrahedron, package = "spantreeorbits")
data(dual_tetrahedron, package = "spantreeorbits")
data(rhombic_dodecahedron, package = "spantreeorbits")

# These are representatives of the right cosets of S3xS3 in S6
reps <- rbind(
  c(1, 2, 3, 4, 5, 6),
  c(1, 2, 3, 4, 6, 5),
  c(1, 2, 4, 3, 5, 6),
  c(1, 2, 4, 3, 6, 5),
  c(1, 2, 5, 3, 4, 6),
  c(1, 2, 5, 3, 6, 4),
  c(1, 2, 6, 3, 4, 5),
  c(1, 2, 6, 3, 5, 4),
  c(1, 3, 4, 2, 5, 6),
  c(1, 3, 4, 2, 6, 5),
  c(1, 3, 5, 2, 4, 6),
  c(1, 3, 5, 2, 6, 4),
  c(1, 3, 6, 2, 4, 5),
  c(1, 3, 6, 2, 5, 4),
  c(1, 4, 5, 2, 3, 6),
  c(1, 4, 5, 2, 6, 3),
  c(1, 4, 6, 2, 3, 5),
  c(1, 4, 6, 2, 5, 3),
  c(1, 5, 6, 2, 3, 4),
  c(1, 5, 6, 2, 4, 3)
)

t3 <- reps[,1:3]
d3 <- reps[,4:6]

tinfo <- gen_span_trees(rhombic_dodecahedron$nghmap[,1:2], letters[1:4], t3)
sinfo <- gen_span_trees(rhombic_dodecahedron$nghmap[,3:4], letters[1:4], d3)

poly <- rhombic_dodecahedron

verts1 <- tetrahedron$verts
verts2 <- dual_tetrahedron$verts
elist1 <- poly$nghmap[,1:2]
elist2 <- poly$nghmap[,3:4]
sts1 <- tinfo$sts
sts2 <- sinfo$sts

tet <- map_trees_to_poly(verts1, 1, elist1, sts1, sts2) %>% 
  append(list(texts = tetrahedron$texts))
dual <- map_trees_to_poly(verts2, 1, elist2, sts2, sts1) %>% 
  append(list(texts = dual_tetrahedron$texts))

```


```{r display1, fig.cap=c("Figure 1. A tetrahedron and its dual, with spanning trees."), fig.height=3, fig.width=5}
display_pairs(tet, dual, 1)

```
```

